{
  "version": 3,
  "sources": ["src/index.ts", "src/utils.ts", "src/registry.ts"],
  "sourcesContent": ["import { DomTriggerData, DomTriggerHandler } from \"./types\";\r\nimport { getTriggerNames, collectData, isKebabName } from \"./utils\";\r\nimport { Registry } from \"./registry\";\r\n\r\nconst JS_PREFIX = \"js-\";\r\n\r\nconst LOAD_PREFIX = `${JS_PREFIX}load-`;\r\n\r\ntype DomEventName =\r\n\t| keyof HTMLElementEventMap\r\n\t| keyof DocumentEventMap\r\n\t| keyof WindowEventMap;\r\n\r\nconst EVENT_PREFIX_MAP: Partial<Record<DomEventName, string>> = {\r\n\t// --- \u30E6\u30FC\u30B6\u30FC\u64CD\u4F5C\uFF08\u30AF\u30EA\u30C3\u30AF\u30FB\u30D5\u30A9\u30FC\u30E0\u306A\u3069\uFF09 ---\r\n\tclick: `${JS_PREFIX}click-`,\r\n\tsubmit: `${JS_PREFIX}submit-`,\r\n\tchange: `${JS_PREFIX}change-`,\r\n\tinput: `${JS_PREFIX}input-`,\r\n\t// --- \u30AD\u30FC\u30DC\u30FC\u30C9 ---\r\n\tkeydown: `${JS_PREFIX}keydown-`,\r\n\tkeyup: `${JS_PREFIX}keyup-`,\r\n\t// --- \u30D5\u30A9\u30FC\u30AB\u30B9 ---\r\n\tfocusin: `${JS_PREFIX}focusin-`,\r\n\tfocusout: `${JS_PREFIX}focusout-`,\r\n\t// --- \u30DD\u30A4\u30F3\u30BF\u30FC\uFF0F\u30DE\u30A6\u30B9 ---\r\n\tpointerdown: `${JS_PREFIX}pointerdown-`,\r\n\tpointerup: `${JS_PREFIX}pointerup-`,\r\n\tmouseover: `${JS_PREFIX}mouseover-`,\r\n\tmouseout: `${JS_PREFIX}mouseout-`,\r\n\t// --- \u30E1\u30C7\u30A3\u30A2\u95A2\u9023 ---\r\n\tplay: `${JS_PREFIX}play-`,\r\n\tpause: `${JS_PREFIX}pause-`,\r\n\tended: `${JS_PREFIX}ended-`,\r\n\t// --- \u30C8\u30E9\u30F3\u30B8\u30B7\u30E7\u30F3\uFF0F\u30A2\u30CB\u30E1\u30FC\u30B7\u30E7\u30F3 ---\r\n\ttransitionend: `${JS_PREFIX}transitionend-`,\r\n\tanimationend: `${JS_PREFIX}animationend-`,\r\n\t// --- \u30DA\u30FC\u30B8\u72B6\u614B ---\r\n\tvisibilitychange: `${JS_PREFIX}visibilitychange-`,\r\n\tpageshow: `${JS_PREFIX}pageshow-`,\r\n\tpagehide: `${JS_PREFIX}pagehide-`,\r\n\t// --- \u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\uFF0F\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9 ---\r\n\tonline: `${JS_PREFIX}online-`,\r\n\toffline: `${JS_PREFIX}offline-`,\r\n\tcopy: `${JS_PREFIX}copy-`,\r\n\tpaste: `${JS_PREFIX}paste-`,\r\n};\r\n\r\nconst eventBound = new Set<string>();\r\n\r\nfunction use(name: string, handler: DomTriggerHandler) {\r\n\tif (!isKebabName(name)) {\r\n\t\tthrow new Error(\r\n\t\t\t`[DomTrigger.use] Invalid trigger name: \"${name}\". Use kebab-case.`\r\n\t\t);\r\n\t}\r\n\tRegistry.set(name, handler);\r\n}\r\n\r\nasync function invoke(name: string, el: Element, event?: Event) {\r\n\tif (!isKebabName(name)) {\r\n\t\tthrow new Error(\r\n\t\t\t`[DomTrigger.invoke] Invalid trigger name: \"${name}\". Use kebab-case.`\r\n\t\t);\r\n\t}\r\n\tconst handler = Registry.get(name);\r\n\tif (!handler) return;\r\n\tconst data = collectData(el, name);\r\n\tawait handler(el, data, { name, event });\r\n}\r\n\r\nasync function run(name: string, el: Element | null, data?: DomTriggerData) {\r\n\tif (!isKebabName(name)) {\r\n\t\tthrow new Error(\r\n\t\t\t`[DomTrigger.run] Invalid trigger name: \"${name}\". Use kebab-case.`\r\n\t\t);\r\n\t}\r\n\tconst handler = Registry.get(name);\r\n\tif (!handler) return;\r\n\tawait handler(el, data ?? {}, { name });\r\n}\r\n\r\nasync function runLoad() {\r\n\tif (typeof document === \"undefined\") return;\r\n\tconst nodes = Array.from(\r\n\t\tdocument.querySelectorAll(\r\n\t\t\t`[class^=\"${LOAD_PREFIX}\"], [class*=\" ${LOAD_PREFIX}\"]`\r\n\t\t)\r\n\t);\r\n\tfor (const el of nodes) {\r\n\t\tconst names = getTriggerNames(el, LOAD_PREFIX);\r\n\t\tfor (const name of names) void invoke(name, el);\r\n\t}\r\n}\r\n\r\nasync function runShow() {\r\n\tif (typeof document === \"undefined\") return;\r\n\tconst showPrefix = EVENT_PREFIX_MAP.pageshow;\r\n\tif (showPrefix === undefined) return;\r\n\tconst nodes = Array.from(\r\n\t\tdocument.querySelectorAll(\r\n\t\t\t`[class^=\"${showPrefix}\"], [class*=\" ${showPrefix}\"]`\r\n\t\t)\r\n\t);\r\n\tfor (const el of nodes) {\r\n\t\tconst names = getTriggerNames(el, showPrefix);\r\n\t\tfor (const name of names) void invoke(name, el);\r\n\t}\r\n}\r\n\r\nfunction listenDelegated(eventName: DomEventName) {\r\n\tif (typeof document === \"undefined\") return;\r\n\tif (eventBound.has(eventName)) return;\r\n\teventBound.add(eventName);\r\n\r\n\tconst prefix = EVENT_PREFIX_MAP[eventName];\r\n\tif (!prefix) return;\r\n\r\n\tdocument.addEventListener(eventName, (ev: Event) => {\r\n\t\tconst target = ev.target as Element | null;\r\n\t\tif (!target) return;\r\n\r\n\t\tconst el = target.closest(`[class^=\"${prefix}\"], [class*=\" ${prefix}\"]`);\r\n\t\tif (!el) return;\r\n\r\n\t\tconst names = getTriggerNames(el, prefix);\r\n\t\tfor (const name of names) invoke(name, el, ev);\r\n\t});\r\n}\r\n\r\nfunction listen() {\r\n\tfor (const ev of Object.keys(EVENT_PREFIX_MAP))\r\n\t\tlistenDelegated(ev as DomEventName);\r\n}\r\n\r\nfunction unuse(name: string) {\r\n\tRegistry.delete(name);\r\n}\r\n\r\nfunction clear() {\r\n\tRegistry.clear();\r\n}\r\n\r\nexport const DomTrigger = {\r\n\tuse,\r\n\tinvoke,\r\n\trun,\r\n\trunLoad,\r\n\trunShow,\r\n\tunuse,\r\n\tclear,\r\n};\r\n\r\nif (typeof document !== \"undefined\") {\r\n\tdocument.addEventListener(\"DOMContentLoaded\", () => {\r\n\t\trunLoad();\r\n\t\trunShow();\r\n\t\tlisten();\r\n\t});\r\n}\r\n", "export function isKebabName(name: string): boolean {\r\n\treturn /^[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(name);\r\n}\r\n\r\nexport function getTriggerNames(el: Element, prefix: string): string[] {\r\n\tconst classes = (el.getAttribute(\"class\") || \"\").split(/\\s+/);\r\n\tconst names: string[] = [];\r\n\tfor (const cls of classes) {\r\n\t\tif (!cls.startsWith(prefix)) continue;\r\n\t\tconst name = cls.slice(prefix.length);\r\n\t\tif (isKebabName(name)) names.push(name);\r\n\t}\r\n\treturn names;\r\n}\r\n\r\nexport function collectData(\r\n\tel: Element,\r\n\tname: string\r\n): Record<string, unknown> {\r\n\tconst raw = el.getAttribute(`data-${name}`);\r\n\tif (!raw) return {};\r\n\ttry {\r\n\t\treturn JSON.parse(raw);\r\n\t} catch {\r\n\t\tthrow new Error(`[DomTrigger] Invalid JSON in data-${name}: ${raw}`);\r\n\t}\r\n}\r\n", "import { DomTriggerHandler } from \"./types\";\r\n\r\nconst map = new Map<string, DomTriggerHandler>();\r\n\r\nexport const Registry = {\r\n\tset(name: string, handler: DomTriggerHandler) {\r\n\t\tmap.set(name, handler);\r\n\t},\r\n\tget(name: string): DomTriggerHandler | undefined {\r\n\t\treturn map.get(name);\r\n\t},\r\n\tdelete(name: string) {\r\n\t\tmap.delete(name);\r\n\t},\r\n\tclear() {\r\n\t\tmap.clear();\r\n\t},\r\n};\r\n"],
  "mappings": "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",
  "names": ["index_exports", "__export", "DomTrigger", "isKebabName", "name", "getTriggerNames", "el", "prefix", "classes", "names", "cls", "collectData", "raw", "map", "Registry", "name", "handler", "JS_PREFIX", "LOAD_PREFIX", "EVENT_PREFIX_MAP", "eventBound", "use", "name", "handler", "isKebabName", "Registry", "invoke", "el", "event", "data", "collectData", "run", "runLoad", "nodes", "names", "getTriggerNames", "runShow", "showPrefix", "listenDelegated", "eventName", "prefix", "ev", "target", "listen", "unuse", "clear", "DomTrigger"]
}
