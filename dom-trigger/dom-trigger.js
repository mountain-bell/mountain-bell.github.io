"use strict";var DomTrigger=(()=>{var E=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var H=(e,t)=>{for(var i in t)E(e,i,{get:t[i],enumerable:!0})},N=(e,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of F(t))!x.call(e,n)&&n!==i&&E(e,n,{get:()=>t[n],enumerable:!(o=L(t,n))||o.enumerable});return e};var W=e=>N(E({},"__esModule",{value:!0}),e);var Y={};H(Y,{default:()=>Q});function p(e){return/^[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(e)}function d(e,t){let i=[];return e.classList.forEach(o=>{if(!o.startsWith(t))return;let n=o.slice(t.length);p(n)&&i.push(n)}),i}var h=new WeakMap;function R(e,t){let i=`data-uncache-${t}`,o=!e.hasAttribute(i);if(o){let g=h.get(e)?.get(t);if(g)return g}let n=o?`data-${t}`:i,s=e.getAttribute(n);if(!s)return{};let c;try{c=JSON.parse(s)}catch{throw new Error(`[DomTrigger] Invalid JSON in ${n}: ${s}`)}if(o){let a=h.get(e)??new Map;a.set(t,c),h.set(e,a)}return c}function T(e,t){let i=e.boundingClientRect,o=i.top+i.height/2,n=window.innerHeight/2;return Math.abs(o-n)<=t}var w=new Map,l={set(e,t){w.set(e,t)},get(e){return w.get(e)},delete(e){w.delete(e)},clear(){w.clear()}};var r="js-",$=`${r}load-`,y=`${r}viewin-`,v=`${r}viewout-`,A="view-center",S="view-ratio",b=new WeakMap,D={click:`${r}click-`,submit:`${r}submit-`,change:`${r}change-`,input:`${r}input-`,focusin:`${r}focusin-`,focusout:`${r}focusout-`,pointerdown:`${r}pointerdown-`,pointermove:`${r}pointermove-`,pointerup:`${r}pointerup-`,pointercancel:`${r}pointercancel-`,transitionend:`${r}transitionend-`,animationend:`${r}animationend-`,visibilitychange:`${r}visibilitychange-`,pageshow:`${r}pageshow-`,pagehide:`${r}pagehide-`,online:`${r}online-`,offline:`${r}offline-`,copy:`${r}copy-`,paste:`${r}paste-`,keydown:`${r}keydown-`,keyup:`${r}keyup-`,mouseover:`${r}mouseover-`,mouseout:`${r}mouseout-`},X=new Set(["visibilitychange","pageshow","pagehide","online","offline"]),I=new Set,k=!1,U=new Set([A,S]);function j(e,t){if(!p(e))throw new Error(`[DomTrigger.use] Invalid trigger name: "${e}". Use kebab-case.`);if(U.has(e))throw new Error(`[DomTrigger.use] Reserved trigger name: "${e}".`);l.set(e,t)}async function z(e,t){if(!p(e))throw new Error(`[DomTrigger.run] Invalid trigger name: "${e}". Use kebab-case.`);let i=l.get(e);i&&await i(t||{})}async function m(e,t,i){if(!p(e))throw new Error(`[DomTrigger.invoke] Invalid trigger name: "${e}". Use kebab-case.`);let o=l.get(e);if(!o)return;let n=R(t,e);await o({el:t,data:n,ctx:{name:e,event:i}})}async function M(){if(typeof document>"u")return;let e=Array.from(document.querySelectorAll(`[class^="${$}"], [class*=" ${$}"]`));for(let t of e){let i=d(t,$);for(let o of i)try{await m(o,t)}catch(n){console.error(`[DomTrigger.invokeLoad] Failed to invoke "${o}":`,t,n)}}}async function _(){if(typeof document>"u")return;let e=D.pageshow;if(!e)return;let t=document.body,i=d(t,e);for(let o of i)try{await m(o,t)}catch(n){console.error(`[DomTrigger.invokeShow] Failed to invoke "${o}":`,t,n)}}function G(e){if(typeof document>"u"||I.has(e))return;I.add(e);let t=D[e];if(!t)return;(e==="online"||e==="offline"?window:document).addEventListener(e,n=>{if(e==="pointermove"&&!k)return;(e==="pointerup"||e==="pointercancel")&&(k=!1);let s=X.has(e)?document.body:n.target instanceof Element?n.target:null;if(!s)return;let c=s.closest(`[class^="${t}"], [class*=" ${t}"]`);if(!c)return;e==="pointerdown"&&(k=!0);let a=d(c,t);for(let g of a)m(g,c,n)})}function P(){for(let e of Object.keys(D))G(e)}function O(){if(typeof document>"u"||typeof IntersectionObserver>"u")return;let e=new IntersectionObserver(o=>{for(let n of o){if(!(n.target instanceof Element))continue;let s=n.target,c=!1,a=s.getAttribute(`data-${A}`);if(a!==null){let u=a?parseInt(a,10):20,f=u>=0?u:20;c=T(n,f)}else{let u=s.getAttribute(`data-${S}`),f=u?parseFloat(u):0,C=f>=0&&f<=1?f:0;c=n.intersectionRatio>=C}let g=b.get(s);if(n.isIntersecting&&c){if(g==="in")continue;let u=d(s,y);for(let f of u)m(f,s);b.set(s,"in")}else{if(g!=="in")continue;let u=d(s,v);for(let f of u)m(f,s);b.set(s,"out")}}},{threshold:Array.from({length:11},(o,n)=>n/10)}),t=[`[class^="${y}"]`,`[class*=" ${y}"]`,`[class^="${v}"]`,`[class*=" ${v}"]`].join(", ");document.querySelectorAll(t).forEach(o=>e.observe(o))}function J(e){l.delete(e)}function q(){l.clear()}async function V(){await M(),await _(),P(),O()}async function K(){if(!(typeof document>"u")){document.readyState==="loading"&&await new Promise(e=>{document.addEventListener("DOMContentLoaded",()=>e(),{once:!0})});try{await V()}catch(e){console.error("[DomTrigger.setupOnReady] Failed to setup:",e)}}}var B={use:j,run:z,invoke:m,invokeLoad:M,invokeShow:_,listen:P,observeView:O,unuse:J,clear:q,setup:V,setupOnReady:K},Q=B;return W(Y);})();
DomTrigger = DomTrigger.default || DomTrigger;
//# sourceMappingURL=dom-trigger.js.map
