"use strict";var DomTrigger=(()=>{var D=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var X=Object.prototype.hasOwnProperty;var z=(e,t)=>{for(var r in t)D(e,r,{get:t[r],enumerable:!0})},J=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of C(t))!X.call(e,i)&&i!==r&&D(e,i,{get:()=>t[i],enumerable:!(n=G(t,i))||n.enumerable});return e};var K=e=>J(D({},"__esModule",{value:!0}),e);var ue={};z(ue,{default:()=>ce});function l(e,t,r){if(typeof e!==t)throw new TypeError(r)}function _(e,t){if(typeof e!="object"||e===null)throw new TypeError(t)}function k(e,t){if(!(e instanceof Element))throw new TypeError(t)}function P(e,t){if(!(e instanceof Event))throw new TypeError(t)}function d(e){return/^[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(e)}function S(e,t){let r=[],n=e;for(;n;)n.matches(`[class^="${t}"], [class*=" ${t}"]`)&&r.push(n),n=n.parentElement;return r}function E(e,t){let r=[];return e.classList.forEach(n=>{if(!n.startsWith(t))return;let i=n.slice(t.length);d(i)&&r.push(i)}),r}var $=new WeakMap,T="uncache";function O(e,t){let r=`data-${T}-${t}`,n=!e.hasAttribute(r);if(n){let g=$.get(e)?.get(t);if(g)return g}let i=n?`data-${t}`:r,s=e.getAttribute(i);if(!s)return{};let c;try{c=JSON.parse(s)}catch{throw new Error(`[DomTrigger] Invalid JSON in ${i}: ${s}`)}if(n){let a=$.get(e)??new Map;a.set(t,c),$.set(e,a)}return c}var h=new Map,f={set(e,t){h.set(e,t)},get(e){return h.get(e)},delete(e){h.delete(e)},clear(){h.clear()}};var o="js-",V={load:`${o}load-`,pageshow:`${o}pageshow-`,visibilitychange:`${o}visibilitychange-`,pagehide:`${o}pagehide-`,offline:`${o}offline-`,online:`${o}online-`,click:`${o}click-`,submit:`${o}submit-`,change:`${o}change-`,input:`${o}input-`,focusin:`${o}focusin-`,focusout:`${o}focusout-`,pointerdown:`${o}pointerdown-`,pointermove:`${o}pointermove-`,pointerup:`${o}pointerup-`,pointercancel:`${o}pointercancel-`,transitionend:`${o}transitionend-`,animationend:`${o}animationend-`,copy:`${o}copy-`,paste:`${o}paste-`,keydown:`${o}keydown-`,keyup:`${o}keyup-`,mouseover:`${o}mouseover-`,mouseout:`${o}mouseout-`},x=new Set(["load","pageshow","pagehide","offline","online"]),q=new Set(["visibilitychange",...x]),A=Object.keys(V),L="prevent-default",W="stop-propagation",B=A.map(e=>`${e}-${L}`),Q=A.map(e=>`${e}-${W}`),M=new Set,b=!1,y=`${o}viewin-`,I=`${o}viewout-`,H="view-ratio",Y=[`[class^="${y}"]`,`[class*=" ${y}"]`,`[class^="${I}"]`,`[class*=" ${I}"]`].join(", "),w=null,N=new WeakSet,R=new WeakMap,Z=new Set([...B,...Q,H,T]),ee=`${T}-`;function te(e,t){if(l(e,"string","[DomTrigger.use] Invalid argument: the first parameter must be a string."),l(t,"function","[DomTrigger.use] Invalid argument: the second parameter must be a function."),!d(e))throw new Error(`[DomTrigger.use] Invalid trigger name: "${e}". Use kebab-case.`);if(Z.has(e)||e.startsWith(ee))throw new Error(`[DomTrigger.use] Reserved trigger name: "${e}".`);f.set(e,t)}async function ne(e,t){if(l(e,"string","[DomTrigger.run] Invalid argument: the first parameter must be a string."),t!==void 0&&_(t,"[DomTrigger.run] Invalid argument: the second parameter must be an object when provided."),!d(e))throw new Error(`[DomTrigger.run] Invalid trigger name: "${e}". Use kebab-case.`);let r=f.get(e);if(!r)return;let n=t?.el,i=t?.data,s=t?.event;await r({el:n,data:i,ctx:{name:e,source:"run",event:s}})}async function v(e,t,r){if(l(e,"string","[DomTrigger.invoke] Invalid argument: the first parameter must be a string."),k(t,"[DomTrigger.invoke] Invalid argument: the second parameter must be an Element."),r!==void 0&&P(r,"[DomTrigger.invoke] Invalid argument: the third parameter must be an Event when provided."),!d(e))throw new Error(`[DomTrigger.invoke] Invalid trigger name: "${e}". Use kebab-case.`);let n=f.get(e);if(!n)return;let i=O(t,e);await n({el:t,data:i,ctx:{name:e,source:"invoke",event:r}})}function re(e){if(typeof document>"u"||M.has(e))return;M.add(e);let t=V[e];if(!t)return;(x.has(e)?window:document).addEventListener(e,n=>{if(e==="pointermove"&&!b)return;(e==="pointerup"||e==="pointercancel")&&(b=!1);let i=q.has(e)?document.body:n.target instanceof Element?n.target:null;if(!i)return;let s=S(i,t);if(s.length===0)return;e==="pointerdown"&&(b=!0);let c=!1;for(let a of s){if(!c){let u=a.getAttribute(`data-${e}-${L}`);u!==null&&u!=="false"&&(n.preventDefault(),c=!0)}let g=a.getAttribute(`data-${e}-${W}`),p=g!==null&&g!=="false",m=E(a,t);for(let u of m)v(u,a,n);if(p){n.stopImmediatePropagation();break}}})}function F(){for(let e of A)re(e)}function U(){if(typeof document>"u"||typeof IntersectionObserver>"u")return;w||(w=new IntersectionObserver(t=>{for(let r of t){if(!(r.target instanceof Element))continue;let n=r.target,i=n.getAttribute(`data-${H}`),s=i?parseFloat(i):0,c=s>=0&&s<=1?s:0,a=r.intersectionRatio,g=r.isIntersecting&&a>=c,p=R.get(n);if(g){if(p==="in")continue;let m=E(n,y);for(let u of m)v(u,n);R.set(n,"in")}else{if(p!=="in")continue;let m=E(n,I);for(let u of m)v(u,n);R.set(n,"out")}}},{threshold:Array.from({length:11},(t,r)=>r/10)})),document.querySelectorAll(Y).forEach(t=>{w&&!N.has(t)&&(w.observe(t),N.add(t))})}function oe(e){if(l(e,"string","[DomTrigger.unuse] Invalid argument: the first parameter must be a string."),!d(e))throw new Error(`[DomTrigger.unuse] Invalid trigger name: "${e}". Use kebab-case.`);f.delete(e)}function ie(){f.clear()}function j(){F(),U()}function se(e){if(e!==void 0&&l(e,"function","[DomTrigger.setupOnReady] Invalid argument: the first parameter must be a function when provided."),typeof document>"u")return;let t=()=>{try{j()}catch(r){console.error("[DomTrigger.setupOnReady] Failed to setup:",r)}e?.()};if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",t,{once:!0});return}t()}var ae={use:te,run:ne,invoke:v,listen:F,observeView:U,unuse:oe,clear:ie,setup:j,setupOnReady:se},ce=ae;return K(ue);})();
DomTrigger = DomTrigger.default || DomTrigger;
//# sourceMappingURL=dom-trigger.js.map
