"use strict";var DomTrigger=(()=>{var $=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var X=Object.getOwnPropertyNames;var j=Object.prototype.hasOwnProperty;var z=(e,t)=>{for(var n in t)$(e,n,{get:t[n],enumerable:!0})},J=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of X(t))!j.call(e,r)&&r!==n&&$(e,r,{get:()=>t[r],enumerable:!(o=G(t,r))||o.enumerable});return e};var q=e=>J($({},"__esModule",{value:!0}),e);var ue={};z(ue,{default:()=>ce});function d(e){return/^[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(e)}function f(e,t){let n=[];return e.classList.forEach(o=>{if(!o.startsWith(t))return;let r=o.slice(t.length);d(r)&&n.push(r)}),n}var h=new WeakMap,E="uncache";function _(e,t){let n=`data-${E}-${t}`,o=!e.hasAttribute(n);if(o){let a=h.get(e)?.get(t);if(a)return a}let r=o?`data-${t}`:n,u=e.getAttribute(r);if(!u)return{};let c;try{c=JSON.parse(u)}catch{throw new Error(`[DomTrigger] Invalid JSON in ${r}: ${u}`)}if(o){let s=h.get(e)??new Map;s.set(t,c),h.set(e,s)}return c}function P(e,t){let n=e.boundingClientRect,o=n.top+n.height/2,r=window.innerHeight/2;return Math.abs(o-r)<=t}var m=new Map,l={set(e,t){m.set(e,t)},get(e){return m.get(e)},delete(e){m.delete(e)},clear(){m.clear()}};var i="js-",v=`${i}load-`,T=`${i}viewin-`,y=`${i}viewout-`,S="view-center",M="view-ratio",K=[`[class^="${T}"]`,`[class*=" ${T}"]`,`[class^="${y}"]`,`[class*=" ${y}"]`].join(", "),w=null,I=new WeakSet,A=new WeakMap,b={click:`${i}click-`,submit:`${i}submit-`,change:`${i}change-`,input:`${i}input-`,focusin:`${i}focusin-`,focusout:`${i}focusout-`,pointerdown:`${i}pointerdown-`,pointermove:`${i}pointermove-`,pointerup:`${i}pointerup-`,pointercancel:`${i}pointercancel-`,transitionend:`${i}transitionend-`,animationend:`${i}animationend-`,visibilitychange:`${i}visibilitychange-`,pageshow:`${i}pageshow-`,pagehide:`${i}pagehide-`,online:`${i}online-`,offline:`${i}offline-`,copy:`${i}copy-`,paste:`${i}paste-`,keydown:`${i}keydown-`,keyup:`${i}keyup-`,mouseover:`${i}mouseover-`,mouseout:`${i}mouseout-`},B=new Set(["visibilitychange","pageshow","pagehide","online","offline"]),D=Object.keys(b),N="prevent-default",O="stop-propagation",Q=D.map(e=>`${e}-${N}`),Y=D.map(e=>`${e}-${O}`),k=new Set,R=!1,Z=new Set([S,M,...Q,...Y,E]),ee=`${E}-`;function te(e,t){if(!d(e))throw new Error(`[DomTrigger.use] Invalid trigger name: "${e}". Use kebab-case.`);if(Z.has(e)||e.startsWith(ee))throw new Error(`[DomTrigger.use] Reserved trigger name: "${e}".`);l.set(e,t)}async function ne(e,t){if(!d(e))throw new Error(`[DomTrigger.run] Invalid trigger name: "${e}". Use kebab-case.`);let n=l.get(e);n&&await n(t||{})}async function g(e,t,n){if(!d(e))throw new Error(`[DomTrigger.invoke] Invalid trigger name: "${e}". Use kebab-case.`);let o=l.get(e);if(!o)return;let r=_(t,e);await o({el:t,data:r,ctx:{name:e,event:n}})}async function V(){if(typeof document>"u")return;let e=Array.from(document.querySelectorAll(`[class^="${v}"], [class*=" ${v}"]`));for(let t of e){let n=f(t,v);for(let o of n)try{await g(o,t)}catch(r){console.error(`[DomTrigger.invokeLoad] Failed to invoke "${o}":`,t,r)}}}async function L(){if(typeof document>"u")return;let e=b.pageshow;if(!e)return;let t=document.body,n=f(t,e);for(let o of n)try{await g(o,t)}catch(r){console.error(`[DomTrigger.invokeShow] Failed to invoke "${o}":`,t,r)}}function oe(e){if(typeof document>"u"||k.has(e))return;k.add(e);let t=b[e];if(!t)return;(e==="online"||e==="offline"?window:document).addEventListener(e,r=>{if(e==="pointermove"&&!R)return;(e==="pointerup"||e==="pointercancel")&&(R=!1);let u=B.has(e)?document.body:r.target instanceof Element?r.target:null;if(!u)return;let c=u.closest(`[class^="${t}"], [class*=" ${t}"]`);if(!c)return;let s=c.getAttribute(`data-${e}-${N}`);s!==null&&s!=="false"&&r.preventDefault();let p=c.getAttribute(`data-${e}-${O}`);p!==null&&p!=="false"&&r.stopPropagation(),e==="pointerdown"&&(R=!0);let x=f(c,t);for(let U of x)g(U,c,r)})}function C(){for(let e of D)oe(e)}function F(){if(typeof document>"u"||typeof IntersectionObserver>"u")return;w||(w=new IntersectionObserver(t=>{for(let n of t){if(!(n.target instanceof Element))continue;let o=n.target,r=!1,u=o.getAttribute(`data-${S}`);if(u!==null){let s=u?parseInt(u,10):20,a=s>=0?s:20;r=P(n,a)}else{let s=o.getAttribute(`data-${M}`),a=s?parseFloat(s):0,p=a>=0&&a<=1?a:0;r=n.intersectionRatio>=p}let c=A.get(o);if(n.isIntersecting&&r){if(c==="in")continue;let s=f(o,T);for(let a of s)g(a,o);A.set(o,"in")}else{if(c!=="in")continue;let s=f(o,y);for(let a of s)g(a,o);A.set(o,"out")}}},{threshold:Array.from({length:11},(t,n)=>n/10)})),document.querySelectorAll(K).forEach(t=>{w&&!I.has(t)&&(w.observe(t),I.add(t))})}function re(e){l.delete(e)}function ie(){l.clear()}async function H(){await V(),await L(),C(),F()}async function se(){if(!(typeof document>"u")){document.readyState==="loading"&&await new Promise(e=>{document.addEventListener("DOMContentLoaded",()=>e(),{once:!0})});try{await H()}catch(e){console.error("[DomTrigger.setupOnReady] Failed to setup:",e)}}}var ae={use:te,run:ne,invoke:g,invokeLoad:V,invokeShow:L,listen:C,observeView:F,unuse:re,clear:ie,setup:H,setupOnReady:se},ce=ae;return q(ue);})();
DomTrigger = DomTrigger.default || DomTrigger;
//# sourceMappingURL=dom-trigger.js.map
