"use strict";var DomTrigger=(()=>{var w=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var G=(t,e)=>{for(var o in e)w(t,o,{get:e[o],enumerable:!0})},X=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of x(e))!U.call(t,i)&&i!==o&&w(t,i,{get:()=>e[i],enumerable:!(n=F(e,i))||n.enumerable});return t};var j=t=>X(w({},"__esModule",{value:!0}),t);var st={};G(st,{default:()=>it});function l(t){return/^[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(t)}function f(t,e){let o=[];return t.classList.forEach(n=>{if(!n.startsWith(e))return;let i=n.slice(e.length);l(i)&&o.push(i)}),o}var $=new WeakMap,d="uncache";function D(t,e){let o=`data-${d}-${e}`,n=!t.hasAttribute(o);if(n){let s=$.get(t)?.get(e);if(s)return s}let i=n?`data-${e}`:o,a=t.getAttribute(i);if(!a)return{};let u;try{u=JSON.parse(a)}catch{throw new Error(`[DomTrigger] Invalid JSON in ${i}: ${a}`)}if(n){let c=$.get(t)??new Map;c.set(e,u),$.set(t,c)}return u}function y(t,e){let o=t.boundingClientRect,n=o.top+o.height/2,i=window.innerHeight/2;return Math.abs(n-i)<=e}var E=new Map,g={set(t,e){E.set(t,e)},get(t){return E.get(t)},delete(t){E.delete(t)},clear(){E.clear()}};var r="js-",S={load:`${r}load-`,pageshow:`${r}pageshow-`,visibilitychange:`${r}visibilitychange-`,pagehide:`${r}pagehide-`,offline:`${r}offline-`,online:`${r}online-`,click:`${r}click-`,submit:`${r}submit-`,change:`${r}change-`,input:`${r}input-`,focusin:`${r}focusin-`,focusout:`${r}focusout-`,pointerdown:`${r}pointerdown-`,pointermove:`${r}pointermove-`,pointerup:`${r}pointerup-`,pointercancel:`${r}pointercancel-`,transitionend:`${r}transitionend-`,animationend:`${r}animationend-`,copy:`${r}copy-`,paste:`${r}paste-`,keydown:`${r}keydown-`,keyup:`${r}keyup-`,mouseover:`${r}mouseover-`,mouseout:`${r}mouseout-`},M=new Set(["load","pageshow","pagehide","offline","online"]),z=new Set(["visibilitychange",...M]),v=Object.keys(S),k="prevent-default",N="stop-propagation",J=v.map(t=>`${t}-${k}`),K=v.map(t=>`${t}-${N}`),I=new Set,h=!1,T=`${r}viewin-`,A=`${r}viewout-`,V="view-center",O="view-ratio",q=[`[class^="${T}"]`,`[class*=" ${T}"]`,`[class^="${A}"]`,`[class*=" ${A}"]`].join(", "),p=null,P=new WeakSet,R=new WeakMap,B=new Set([...J,...K,V,O,d]),Q=`${d}-`;function Y(t,e){if(!l(t))throw new Error(`[DomTrigger.use] Invalid trigger name: "${t}". Use kebab-case.`);if(B.has(t)||t.startsWith(Q))throw new Error(`[DomTrigger.use] Reserved trigger name: "${t}".`);g.set(t,e)}async function Z(t,e){if(!l(t))throw new Error(`[DomTrigger.run] Invalid trigger name: "${t}". Use kebab-case.`);let o=g.get(t);o&&await o(e||{})}async function m(t,e,o){if(!l(t))throw new Error(`[DomTrigger.invoke] Invalid trigger name: "${t}". Use kebab-case.`);let n=g.get(t);if(!n)return;let i=D(e,t);await n({el:e,data:i,ctx:{name:t,event:o}})}function tt(t){if(typeof document>"u"||I.has(t))return;I.add(t);let e=S[t];if(!e)return;(M.has(t)?window:document).addEventListener(t,n=>{if(t==="pointermove"&&!h)return;(t==="pointerup"||t==="pointercancel")&&(h=!1);let i=z.has(t)?document.body:n.target instanceof Element?n.target:null;if(!i)return;let a=i.closest(`[class^="${e}"], [class*=" ${e}"]`);if(!a)return;let u=a.getAttribute(`data-${t}-${k}`);u!==null&&u!=="false"&&n.preventDefault();let s=a.getAttribute(`data-${t}-${N}`);s!==null&&s!=="false"&&n.stopPropagation(),t==="pointerdown"&&(h=!0);let _=f(a,e);for(let H of _)m(H,a,n)})}function C(){for(let t of v)tt(t)}function L(){if(typeof document>"u"||typeof IntersectionObserver>"u")return;p||(p=new IntersectionObserver(e=>{for(let o of e){if(!(o.target instanceof Element))continue;let n=o.target,i=!1,a=n.getAttribute(`data-${V}`);if(a!==null){let c=a?parseInt(a,10):20,s=c>=0?c:20;i=y(o,s)}else{let c=n.getAttribute(`data-${O}`),s=c?parseFloat(c):0,b=s>=0&&s<=1?s:0;i=o.intersectionRatio>=b}let u=R.get(n);if(o.isIntersecting&&i){if(u==="in")continue;let c=f(n,T);for(let s of c)m(s,n);R.set(n,"in")}else{if(u!=="in")continue;let c=f(n,A);for(let s of c)m(s,n);R.set(n,"out")}}},{threshold:Array.from({length:11},(e,o)=>o/10)})),document.querySelectorAll(q).forEach(e=>{p&&!P.has(e)&&(p.observe(e),P.add(e))})}function et(t){g.delete(t)}function nt(){g.clear()}function W(){C(),L()}function ot(){if(typeof document>"u")return;let t=()=>{try{W()}catch(e){console.error("[DomTrigger.setupOnReady] Failed to setup:",e)}};if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",t,{once:!0});return}t()}var rt={use:Y,run:Z,invoke:m,listen:C,observeView:L,unuse:et,clear:nt,setup:W,setupOnReady:ot},it=rt;return j(st);})();
DomTrigger = DomTrigger.default || DomTrigger;
//# sourceMappingURL=dom-trigger.js.map
