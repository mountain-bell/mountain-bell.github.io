"use strict";var DomTrigger=(()=>{var v=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var J=Object.prototype.hasOwnProperty;var K=(e,t)=>{for(var r in t)v(e,r,{get:t[r],enumerable:!0})},q=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of z(t))!J.call(e,i)&&i!==r&&v(e,i,{get:()=>t[i],enumerable:!(n=X(t,i))||n.enumerable});return e};var B=e=>q(v({},"__esModule",{value:!0}),e);var le={};K(le,{default:()=>ge});function g(e,t,r){if(typeof e!==t)throw new TypeError(r)}function _(e,t){if(typeof e!="object"||e===null)throw new TypeError(t)}function P(e,t){if(!(e instanceof Element))throw new TypeError(t)}function k(e,t){if(!(e instanceof Event))throw new TypeError(t)}function l(e){return/^[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(e)}function S(e,t){let r=[],n=e;for(;n;)n.matches(`[class^="${t}"], [class*=" ${t}"]`)&&r.push(n),n=n.parentElement;return r}function m(e,t){let r=[];return e.classList.forEach(n=>{if(!n.startsWith(t))return;let i=n.slice(t.length);l(i)&&r.push(i)}),r}var D=new WeakMap,p="uncache";function O(e,t){let r=`data-${p}-${t}`,n=!e.hasAttribute(r);if(n){let a=D.get(e)?.get(t);if(a)return a}let i=n?`data-${t}`:r,c=e.getAttribute(i);if(!c)return{};let u;try{u=JSON.parse(c)}catch{throw new Error(`[DomTrigger] Invalid JSON in ${i}: ${c}`)}if(n){let s=D.get(e)??new Map;s.set(t,u),D.set(e,s)}return u}function M(e,t){let r=e.boundingClientRect,n=r.top+r.height/2,i=window.innerHeight/2;return Math.abs(n-i)<=t}var E=new Map,f={set(e,t){E.set(e,t)},get(e){return E.get(e)},delete(e){E.delete(e)},clear(){E.clear()}};var o="js-",x={load:`${o}load-`,pageshow:`${o}pageshow-`,visibilitychange:`${o}visibilitychange-`,pagehide:`${o}pagehide-`,offline:`${o}offline-`,online:`${o}online-`,click:`${o}click-`,submit:`${o}submit-`,change:`${o}change-`,input:`${o}input-`,focusin:`${o}focusin-`,focusout:`${o}focusout-`,pointerdown:`${o}pointerdown-`,pointermove:`${o}pointermove-`,pointerup:`${o}pointerup-`,pointercancel:`${o}pointercancel-`,transitionend:`${o}transitionend-`,animationend:`${o}animationend-`,copy:`${o}copy-`,paste:`${o}paste-`,keydown:`${o}keydown-`,keyup:`${o}keyup-`,mouseover:`${o}mouseover-`,mouseout:`${o}mouseout-`},C=new Set(["load","pageshow","pagehide","offline","online"]),Q=new Set(["visibilitychange",...C]),y=Object.keys(x),L="prevent-default",W="stop-propagation",Y=y.map(e=>`${e}-${L}`),Z=y.map(e=>`${e}-${W}`),N=new Set,$=!1,R=`${o}viewin-`,I=`${o}viewout-`,H="view-center",F="view-ratio",ee=[`[class^="${R}"]`,`[class*=" ${R}"]`,`[class^="${I}"]`,`[class*=" ${I}"]`].join(", "),h=null,V=new WeakSet,b=new WeakMap,te=new Set([...Y,...Z,H,F,p]),ne=`${p}-`;function re(e,t){if(g(e,"string","[DomTrigger.use] Invalid argument: the first parameter must be a string."),g(t,"function","[DomTrigger.use] Invalid argument: the second parameter must be a function."),!l(e))throw new Error(`[DomTrigger.use] Invalid trigger name: "${e}". Use kebab-case.`);if(te.has(e)||e.startsWith(ne))throw new Error(`[DomTrigger.use] Reserved trigger name: "${e}".`);f.set(e,t)}async function oe(e,t){if(g(e,"string","[DomTrigger.run] Invalid argument: the first parameter must be a string."),t!==void 0&&_(t,"[DomTrigger.run] Invalid argument: the second parameter must be an object when provided."),!l(e))throw new Error(`[DomTrigger.run] Invalid trigger name: "${e}". Use kebab-case.`);let r=f.get(e);if(!r)return;let n=t?.el,i=t?.data,c=t?.event;await r({el:n,data:i,ctx:{name:e,source:"run",event:c}})}async function w(e,t,r){if(g(e,"string","[DomTrigger.invoke] Invalid argument: the first parameter must be a string."),P(t,"[DomTrigger.invoke] Invalid argument: the second parameter must be an Element."),r!==void 0&&k(r,"[DomTrigger.invoke] Invalid argument: the third parameter must be an Event when provided."),!l(e))throw new Error(`[DomTrigger.invoke] Invalid trigger name: "${e}". Use kebab-case.`);let n=f.get(e);if(!n)return;let i=O(t,e);await n({el:t,data:i,ctx:{name:e,source:"invoke",event:r}})}function ie(e){if(typeof document>"u"||N.has(e))return;N.add(e);let t=x[e];if(!t)return;(C.has(e)?window:document).addEventListener(e,n=>{if(e==="pointermove"&&!$)return;(e==="pointerup"||e==="pointercancel")&&($=!1);let i=Q.has(e)?document.body:n.target instanceof Element?n.target:null;if(!i)return;let c=S(i,t);if(c.length===0)return;e==="pointerdown"&&($=!0);let u=!1;for(let s of c){if(!u){let d=s.getAttribute(`data-${e}-${L}`);d!==null&&d!=="false"&&(n.preventDefault(),u=!0)}let a=s.getAttribute(`data-${e}-${W}`),T=a!==null&&a!=="false",A=m(s,t);for(let d of A)w(d,s,n);if(T){n.stopImmediatePropagation();break}}})}function U(){for(let e of y)ie(e)}function j(){if(typeof document>"u"||typeof IntersectionObserver>"u")return;h||(h=new IntersectionObserver(t=>{for(let r of t){if(!(r.target instanceof Element))continue;let n=r.target,i=!1,c=n.getAttribute(`data-${H}`);if(c!==null){let s=c?parseInt(c,10):20,a=s>=0?s:20;i=M(r,a)}else{let s=n.getAttribute(`data-${F}`),a=s?parseFloat(s):0,T=a>=0&&a<=1?a:0;i=r.intersectionRatio>=T}let u=b.get(n);if(r.isIntersecting&&i){if(u==="in")continue;let s=m(n,R);for(let a of s)w(a,n);b.set(n,"in")}else{if(u!=="in")continue;let s=m(n,I);for(let a of s)w(a,n);b.set(n,"out")}}},{threshold:Array.from({length:11},(t,r)=>r/10)})),document.querySelectorAll(ee).forEach(t=>{h&&!V.has(t)&&(h.observe(t),V.add(t))})}function se(e){if(g(e,"string","[DomTrigger.unuse] Invalid argument: the first parameter must be a string."),!l(e))throw new Error(`[DomTrigger.unuse] Invalid trigger name: "${e}". Use kebab-case.`);f.delete(e)}function ae(){f.clear()}function G(){U(),j()}function ce(e){if(e!==void 0&&g(e,"function","[DomTrigger.setupOnReady] Invalid argument: the first parameter must be a function when provided."),typeof document>"u")return;let t=()=>{try{G()}catch(r){console.error("[DomTrigger.setupOnReady] Failed to setup:",r)}e?.()};if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",t,{once:!0});return}t()}var ue={use:re,run:oe,invoke:w,listen:U,observeView:j,unuse:se,clear:ae,setup:G,setupOnReady:ce},ge=ue;return B(le);})();
DomTrigger = DomTrigger.default || DomTrigger;
//# sourceMappingURL=dom-trigger.js.map
