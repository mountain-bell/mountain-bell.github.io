"use strict";var DomTrigger=(()=>{var E=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var N=(e,t)=>{for(var r in t)E(e,r,{get:t[r],enumerable:!0})},W=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of x(t))!H.call(e,n)&&n!==r&&E(e,n,{get:()=>t[n],enumerable:!(i=O(t,n))||i.enumerable});return e};var L=e=>W(E({},"__esModule",{value:!0}),e);var Q={};N(Q,{default:()=>B});function p(e){return/^[a-z][a-z0-9]*(?:-[a-z0-9]+)*$/.test(e)}function l(e,t){let r=[];return e.classList.forEach(i=>{if(!i.startsWith(t))return;let n=i.slice(t.length);p(n)&&r.push(n)}),r}var h=new WeakMap;function D(e,t){let r=`data-uncache-${t}`,i=!e.hasAttribute(r);if(i){let g=h.get(e)?.get(t);if(g)return g}let n=i?`data-${t}`:r,s=e.getAttribute(n);if(!s)return{};let c;try{c=JSON.parse(s)}catch{throw new Error(`[DomTrigger] Invalid JSON in ${n}: ${s}`)}if(i){let a=h.get(e)??new Map;a.set(t,c),h.set(e,a)}return c}function I(e,t){let r=e.boundingClientRect,i=r.top+r.height/2,n=window.innerHeight/2;return Math.abs(i-n)<=t}var w=new Map,d={set(e,t){w.set(e,t)},get(e){return w.get(e)},delete(e){w.delete(e)},clear(){w.clear()}};var o="js-",$=`${o}load-`,v=`${o}viewin-`,y=`${o}viewout-`,A="view-center",_="view-ratio",b=new WeakMap,k={click:`${o}click-`,submit:`${o}submit-`,change:`${o}change-`,input:`${o}input-`,focusin:`${o}focusin-`,focusout:`${o}focusout-`,pointerdown:`${o}pointerdown-`,pointermove:`${o}pointermove-`,pointerup:`${o}pointerup-`,pointercancel:`${o}pointercancel-`,transitionend:`${o}transitionend-`,animationend:`${o}animationend-`,visibilitychange:`${o}visibilitychange-`,pageshow:`${o}pageshow-`,pagehide:`${o}pagehide-`,online:`${o}online-`,offline:`${o}offline-`,copy:`${o}copy-`,paste:`${o}paste-`,keydown:`${o}keydown-`,keyup:`${o}keyup-`,mouseover:`${o}mouseover-`,mouseout:`${o}mouseout-`},F=new Set(["visibilitychange","pageshow","pagehide","online","offline"]),T=new Set,R=!1,X=new Set([A,_]);function U(e,t){if(!p(e))throw new Error(`[DomTrigger.use] Invalid trigger name: "${e}". Use kebab-case.`);if(X.has(e))throw new Error(`[DomTrigger.use] Reserved trigger name: "${e}".`);d.set(e,t)}async function j(e,t){if(!p(e))throw new Error(`[DomTrigger.run] Invalid trigger name: "${e}". Use kebab-case.`);let r=d.get(e);r&&await r(t||{})}async function m(e,t,r){if(!p(e))throw new Error(`[DomTrigger.invoke] Invalid trigger name: "${e}". Use kebab-case.`);let i=d.get(e);if(!i)return;let n=D(t,e);await i({el:t,data:n,ctx:{name:e,event:r}})}async function M(){if(typeof document>"u")return;let e=Array.from(document.querySelectorAll(`[class^="${$}"], [class*=" ${$}"]`));for(let t of e){let r=l(t,$);for(let i of r)m(i,t)}}async function S(){if(typeof document>"u")return;let e=k.pageshow;if(!e)return;let t=document.body,r=l(t,e);for(let i of r)m(i,t)}function z(e){if(typeof document>"u"||T.has(e))return;T.add(e);let t=k[e];if(!t)return;(e==="online"||e==="offline"?window:document).addEventListener(e,n=>{if(e==="pointermove"&&!R)return;(e==="pointerup"||e==="pointercancel")&&(R=!1);let s=F.has(e)?document.body:n.target instanceof Element?n.target:null;if(!s)return;let c=s.closest(`[class^="${t}"], [class*=" ${t}"]`);if(!c)return;e==="pointerdown"&&(R=!0);let a=l(c,t);for(let g of a)m(g,c,n)})}function P(){for(let e of Object.keys(k))z(e)}function V(){if(typeof document>"u"||typeof IntersectionObserver>"u")return;let e=new IntersectionObserver(i=>{for(let n of i){if(!(n.target instanceof Element))continue;let s=n.target,c=!1,a=s.getAttribute(`data-${A}`);if(a!==null){let u=a?parseInt(a,10):20,f=u>=0?u:20;c=I(n,f)}else{let u=s.getAttribute(`data-${_}`),f=u?parseFloat(u):0,C=f>=0&&f<=1?f:0;c=n.intersectionRatio>=C}let g=b.get(s);if(n.isIntersecting&&c){if(g==="in")continue;let u=l(s,v);for(let f of u)m(f,s);b.set(s,"in")}else{if(g!=="in")continue;let u=l(s,y);for(let f of u)m(f,s);b.set(s,"out")}}},{threshold:Array.from({length:11},(i,n)=>n/10)}),t=[`[class^="${v}"]`,`[class*=" ${v}"]`,`[class^="${y}"]`,`[class*=" ${y}"]`].join(", ");document.querySelectorAll(t).forEach(i=>e.observe(i))}function G(e){d.delete(e)}function J(){d.clear()}function q(){M(),S(),P(),V()}var K={use:U,run:j,invoke:m,invokeLoad:M,invokeShow:S,listen:P,observeView:V,unuse:G,clear:J,setup:q},B=K;return L(Q);})();
DomTrigger = DomTrigger.default || DomTrigger;
//# sourceMappingURL=dom-trigger.js.map
